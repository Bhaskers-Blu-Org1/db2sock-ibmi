### make
### make TGT64=64
CC                 = cc
CCFLAGS32          = -g
CCFLAGS64          = $(CCFLAGS32) -q64
AR                 = ar
AROPT              = -X32_64
INCLUDEPATH        = -I. -I/usr/include -I..
LIBDEPALL          = -L. -lpthreads -liconv -ldl -lpthread -ldb400

###  shared lib
LIBOBJS            = LangCommon.o
LIBEXPS            = -bE:liblang400.exp
LIBSHR32           = liblang400.a
LIBOBJ32           = shr.o
LIBDEPS32          = $(LIBDEPALL) -bM:SRE -bnoentry
LIBSHR64           = liblang400_64.a
LIBOBJ64           = shr_64.o
LIBDEPS64          = $(LIBDEPS32)

### TEST0000
TEST0000PGM32      = test0000_theory_db2_resources_32
TEST0000LIBOBJS32  = test0000_theory_db2_resources.o
TEST0000LIBDEPS32  = $(LIBDEPALL) -llang400
TEST0000PGM64      = test0000_theory_db2_resources_64
TEST0000LIBOBJS64  = $(TEST0000LIBOBJS32)
TEST0000LIBDEPS64  = $(LIBDEPALL) -llang400
### TEST0001
TEST0001PGM32      = test0001_normal_connect_32
TEST0001LIBOBJS32  = test0001_normal_connect.o
TEST0001LIBDEPS32  = $(LIBDEPALL) -llang400
TEST0001PGM64      = test0001_normal_connect_64
TEST0001LIBOBJS64  = $(TEST0001LIBOBJS32)
TEST0001LIBDEPS64  = $(LIBDEPALL) -llang400
### TEST0002
TEST0002PGM32      = test0002_async_reap_connect_32
TEST0002LIBOBJS32  = test0002_async_reap_connect.o
TEST0002LIBDEPS32  = $(LIBDEPALL) -llang400
TEST0002PGM64      = test0002_async_reap_connect_64
TEST0002LIBOBJS64  = $(TEST0002LIBOBJS32)
TEST0002LIBDEPS64  = $(LIBDEPALL) -llang400
### TEST0003
TEST0003PGM32      = test0003_async_callback_connect_32
TEST0003LIBOBJS32  = test0003_async_callback_connect.o
TEST0003LIBDEPS32  = $(LIBDEPALL) -llang400
TEST0003PGM64      = test0003_async_callback_connect_64
TEST0003LIBOBJS64  = $(TEST0003LIBOBJS32)
TEST0003LIBDEPS64  = $(LIBDEPALL) -llang400
### TEST0004
TEST0004PGM32      = test0004_async_callback_query_32
TEST0004LIBOBJS32  = test0004_async_callback_query.o
TEST0004LIBDEPS32  = $(LIBDEPALL) -llang400
TEST0004PGM64      = test0004_async_callback_query_64
TEST0004LIBOBJS64  = $(TEST0004LIBOBJS32)
TEST0004LIBDEPS64  = $(LIBDEPALL) -llang400
### TEST0005
TEST0005PGM32      = test0005_async_callback_query_marker_32
TEST0005LIBOBJS32  = test0005_async_callback_query_marker.o
TEST0005LIBDEPS32  = $(LIBDEPALL) -llang400
TEST0005PGM64      = test0005_async_callback_query_marker_64
TEST0005LIBOBJS64  = $(TEST0005LIBOBJS32)
TEST0005LIBDEPS64  = $(LIBDEPALL) -llang400
### TEST0054
TEST0054PGM32      = test0054_async_callback_query_fetch_array_32
TEST0054LIBOBJS32  = test0054_async_callback_query_fetch_array.o
TEST0054LIBDEPS32  = $(LIBDEPALL) -llang400
TEST0054PGM64      = test0054_async_callback_query_fetch_array_64
TEST0054LIBOBJS64  = $(TEST0054LIBOBJS32)
TEST0054LIBDEPS64  = $(LIBDEPALL) -llang400
### TEST0101
TEST0101PGM32      = test0101_normal_connect_utf16_32
TEST0101LIBOBJS32  = test0101_normal_connect_utf16.o
TEST0101LIBDEPS32  = $(LIBDEPALL) -llang400
TEST0101PGM64      = test0101_normal_connect_utf16_64
TEST0101LIBOBJS64  = $(TEST0101LIBOBJS32)
TEST0101LIBDEPS64  = $(LIBDEPALL) -llang400
### TEST0154
TEST0154PGM32      = test0154_async_callback_query_fetch_array_utf16_32
TEST0154LIBOBJS32  = test0154_async_callback_query_fetch_array_utf16.o
TEST0154LIBDEPS32  = $(LIBDEPALL) -llang400
TEST0154PGM64      = test0154_async_callback_query_fetch_array_utf16_64
TEST0154LIBOBJS64  = $(TEST0154LIBOBJS32)
TEST0154LIBDEPS64  = $(LIBDEPALL) -llang400

### make TGT64=64
ifdef TGT64
CCFLAGS            = $(CCFLAGS64)
SHRLIB             = $(LIBSHR32)
SHROBJ             = $(LIBOBJ64)
LIBDEPS            = $(LIBDEPS64)
TEST0000PGM        = $(TEST0000PGM64)
TEST0000LIBOBJS    = $(TEST0000LIBOBJS64)
TEST0000LIBDEPS    = $(TEST0000LIBDEPS64)
TEST0001PGM        = $(TEST0001PGM64)
TEST0001LIBOBJS    = $(TEST0001LIBOBJS64)
TEST0001LIBDEPS    = $(TEST0001LIBDEPS64)
TEST0002PGM        = $(TEST0002PGM64)
TEST0002LIBOBJS    = $(TEST0002LIBOBJS64)
TEST0002LIBDEPS    = $(TEST0002LIBDEPS64)
TEST0003PGM        = $(TEST0003PGM64)
TEST0003LIBOBJS    = $(TEST0003LIBOBJS64)
TEST0003LIBDEPS    = $(TEST0003LIBDEPS64)
TEST0004PGM        = $(TEST0004PGM64)
TEST0004LIBOBJS    = $(TEST0004LIBOBJS64)
TEST0004LIBDEPS    = $(TEST0004LIBDEPS64)
TEST0005PGM        = $(TEST0005PGM64)
TEST0005LIBOBJS    = $(TEST0005LIBOBJS64)
TEST0005LIBDEPS    = $(TEST0005LIBDEPS64)
TEST0054PGM        = $(TEST0054PGM64)
TEST0054LIBOBJS    = $(TEST0054LIBOBJS64)
TEST0054LIBDEPS    = $(TEST0054LIBDEPS64)
TEST0101PGM        = $(TEST0101PGM64)
TEST0101LIBOBJS    = $(TEST0101LIBOBJS64)
TEST0101LIBDEPS    = $(TEST0101LIBDEPS64)
TEST0154PGM        = $(TEST0154PGM64)
TEST0154LIBOBJS    = $(TEST0154LIBOBJS64)
TEST0154LIBDEPS    = $(TEST0154LIBDEPS64)
### make (32)
else
CCFLAGS            = $(CCFLAGS32)
SHRLIB             = $(LIBSHR32)
SHROBJ             = $(LIBOBJ32)
LIBDEPS            = $(LIBDEPS32)
TEST0000PGM        = $(TEST0000PGM32)
TEST0000LIBOBJS    = $(TEST0000LIBOBJS32)
TEST0000LIBDEPS    = $(TEST0000LIBDEPS32)
TEST0001PGM        = $(TEST0001PGM32)
TEST0001LIBOBJS    = $(TEST0001LIBOBJS32)
TEST0001LIBDEPS    = $(TEST0001LIBDEPS32)
TEST0002PGM        = $(TEST0002PGM32)
TEST0002LIBOBJS    = $(TEST0002LIBOBJS32)
TEST0002LIBDEPS    = $(TEST0002LIBDEPS32)
TEST0003PGM        = $(TEST0003PGM32)
TEST0003LIBOBJS    = $(TEST0003LIBOBJS32)
TEST0003LIBDEPS    = $(TEST0003LIBDEPS32)
TEST0004PGM        = $(TEST0004PGM32)
TEST0004LIBOBJS    = $(TEST0004LIBOBJS32)
TEST0004LIBDEPS    = $(TEST0004LIBDEPS32)
TEST0005PGM        = $(TEST0005PGM32)
TEST0005LIBOBJS    = $(TEST0005LIBOBJS32)
TEST0005LIBDEPS    = $(TEST0005LIBDEPS32)
TEST0054PGM        = $(TEST0054PGM32)
TEST0054LIBOBJS    = $(TEST0054LIBOBJS32)
TEST0054LIBDEPS    = $(TEST0054LIBDEPS32)
TEST0101PGM        = $(TEST0101PGM32)
TEST0101LIBOBJS    = $(TEST0101LIBOBJS32)
TEST0101LIBDEPS    = $(TEST0101LIBDEPS32)
TEST0154PGM        = $(TEST0154PGM32)
TEST0154LIBOBJS    = $(TEST0154LIBOBJS32)
TEST0154LIBDEPS    = $(TEST0154LIBDEPS32)
endif

### tells make all things to do (ordered)
all: cpy $(SHRLIB) $(TEST0000PGM) $(TEST0001PGM) $(TEST0002PGM) $(TEST0003PGM) $(TEST0004PGM) $(TEST0005PGM) $(TEST0054PGM) $(TEST0101PGM) $(TEST0154PGM)

### generic rules
### (note: .c.o compiles all c parts in OBJS list)
.SUFFIXES: .o .c
.c.o:
	$(CC) $(CCFLAGS) $(INCLUDEPATH) -c $<

### -- Build the shared lib(s).
$(SHROBJ): $(LIBOBJS)
	$(CC) $(CCFLAGS) $(LIBOBJS) $(LIBEXPS) $(LIBDEPS) -o$(SHROBJ)
$(SHRLIB): $(SHROBJ)
	$(AR) $(AROPT) ruv $(SHRLIB) $(SHROBJ)

### -- test0000_theory_db2_resources_32/64
$(TEST0000PGM32): $(TEST0000LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0000LIBOBJS) $(TEST0000LIBDEPS) -o $(TEST0000PGM32)
$(TEST0000PGM64): $(TEST0000LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0000LIBOBJS) $(TEST0000LIBDEPS) -o $(TEST0000PGM64)
### -- test0001_normal_connect_32/64
$(TEST0001PGM32): $(TEST0001LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0001LIBOBJS) $(TEST0001LIBDEPS) -o $(TEST0001PGM32)
$(TEST0001PGM64): $(TEST0001LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0001LIBOBJS) $(TEST0001LIBDEPS) -o $(TEST0001PGM64)
### -- test0002_async_reap_connect_32/64
$(TEST0002PGM32): $(TEST0002LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0002LIBOBJS) $(TEST0002LIBDEPS) -o $(TEST0002PGM32)
$(TEST0002PGM64): $(TEST0002LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0002LIBOBJS) $(TEST0002LIBDEPS) -o $(TEST0002PGM64)
### -- test0003_async_callback_connect_32/64
$(TEST0003PGM32): $(TEST0003LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0003LIBOBJS) $(TEST0003LIBDEPS) -o $(TEST0003PGM32)
$(TEST0003PGM64): $(TEST0003LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0003LIBOBJS) $(TEST0003LIBDEPS) -o $(TEST0003PGM64)
### -- test0004_async_callback_query_32/64
$(TEST0004PGM32): $(TEST0004LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0004LIBOBJS) $(TEST0004LIBDEPS) -o $(TEST0004PGM32)
$(TEST0004PGM64): $(TEST0004LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0004LIBOBJS) $(TEST0004LIBDEPS) -o $(TEST0004PGM64)
### -- test0005_async_callback_query_marker_32/64
$(TEST0005PGM32): $(TEST0005LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0005LIBOBJS) $(TEST0005LIBDEPS) -o $(TEST0005PGM32)
$(TEST0005PGM64): $(TEST0005LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0005LIBOBJS) $(TEST0005LIBDEPS) -o $(TEST0005PGM64)
### -- test0054_async_callback_query_fetch_array_32/64
$(TEST0054PGM32): $(TEST0054LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0054LIBOBJS) $(TEST0054LIBDEPS) -o $(TEST0054PGM32)
$(TEST0054PGM64): $(TEST0054LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0054LIBOBJS) $(TEST0054LIBDEPS) -o $(TEST0054PGM64)
### -- test0101_normal_connect_utf16_32/64
$(TEST0101PGM32): $(TEST0101LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0101LIBOBJS) $(TEST0101LIBDEPS) -o $(TEST0101PGM32)
$(TEST0101PGM64): $(TEST0101LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0101LIBOBJS) $(TEST0101LIBDEPS) -o $(TEST0101PGM64)
### -- test0154_async_callback_query_fetch_array_utf16_32/64
$(TEST0154PGM32): $(TEST0154LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0154LIBOBJS) $(TEST0154LIBDEPS) -o $(TEST0154PGM32)
$(TEST0154PGM64): $(TEST0154LIBOBJS)
	$(CC) $(CCFLAGS) $(TEST0154LIBOBJS) $(TEST0154LIBDEPS) -o $(TEST0154PGM64)

cpy:
	cp ../libdb400.a .

